(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[317],{5024:function(){},667:function(e,t,s){Promise.resolve().then(s.bind(s,9459))},9459:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var l=s(7437),a=s(2265),i=s(8239),r=s(8614),n=s(8468),d=s(9376),o=s(5398);let c=new n.gK("https://fullnode.testnet.aptoslabs.com/v1");function m(){let e=(0,d.useRouter)(),[t,s]=(0,a.useState)({itemType:"",itemName:"",walletAddress:"",soldBy:"",orderId:"",pickupDate:"",pickupTime:""}),[n,m]=(0,a.useState)(!1),[u,x]=(0,a.useState)(!1),[p,h]=(0,a.useState)(!1),[y,b]=(0,a.useState)(!1),[g,f]=(0,a.useState)(null),[j,w]=(0,a.useState)(!1),[v,N]=(0,a.useState)(null),k=e=>e?e.length<=10?e:"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",C=(0,a.useCallback)(()=>{var e;return null!==(e=window)&&void 0!==e&&!!e.aptos},[]),S=(0,a.useCallback)(async()=>{try{var e,t,l,a,i;if(!C()){b(!1),f(null);return}if(await (null===(e=(t=window.aptos).isConnected)||void 0===e?void 0:e.call(t))){let e=await (null===(l=(a=window.aptos).account)||void 0===l?void 0:l.call(a)),t=null!==(i=null==e?void 0:e.address)&&void 0!==i?i:null;b(!0),f(t),s(e=>({...e,walletAddress:null!=t?t:""}))}else b(!1),f(null),s(e=>({...e,walletAddress:""}))}catch(e){console.error("refreshConnectionState error:",e),b(!1),f(null),s(e=>({...e,walletAddress:""}))}},[C]);(0,a.useEffect)(()=>{var e,t,l,a;if(S(),!C())return;let i=()=>{b(!1),f(null),s(e=>({...e,walletAddress:""}))};try{null===(e=(t=window.aptos).onDisconnect)||void 0===e||e.call(t,i)}catch(e){}try{null===(l=(a=window.aptos).onAccountChange)||void 0===l||l.call(a,e=>{e&&e.address?(b(!0),f(e.address),s(t=>({...t,walletAddress:e.address}))):i()})}catch(e){}return()=>{}},[C,S]);let A=async()=>{var e,t,l;if(N(null),!C()){N("Petra (or compatible Aptos wallet) is not installed. Install from https://petra.app/");return}w(!0);try{let t=await window.aptos.connect(),l=null!==(e=null==t?void 0:t.address)&&void 0!==e?e:null;b(!0),f(l),s(e=>({...e,walletAddress:null!=l?l:""}))}catch(e){console.error("connectWallet error:",e),(null==e?void 0:null===(l=e.message)||void 0===l?void 0:null===(t=l.toLowerCase)||void 0===t?void 0:t.call(l).includes("user rejected"))?N("Connection request rejected by user."):N("Failed to connect to wallet. See console for details."),b(!1),f(null)}finally{w(!1)}},I=async()=>{if(N(null),!C()){N("Wallet provider not available.");return}try{window.aptos.disconnect&&await window.aptos.disconnect(),b(!1),f(null),s(e=>({...e,walletAddress:""}))}catch(e){console.error("disconnectWallet error:",e),N("Failed to disconnect cleanly — refresh the page or disconnect from wallet UI."),b(!1),f(null),s(e=>({...e,walletAddress:""}))}};(0,a.useEffect)(()=>{s(e=>({...e,walletAddress:null!=g?g:""}))},[g]);let T=e=>{let{name:t,value:l}=e.target;s(e=>({...e,[t]:l}))},E=async()=>{if(!g){alert("Please connect your wallet first");return}h(!0),N(null);try{let s={function:"".concat("0xc9d300dfef9ec68f48c519ed3d2e95141f180ec8b2eea83d1ccd4dc98c667284","::ItemRegistry::add_item"),type_arguments:[],arguments:[t.itemType,t.itemName,t.orderId,t.pickupDate,t.pickupTime,t.walletAddress,t.soldBy]},l=await window.aptos.signAndSubmitTransaction(s);await c.waitForTransactionWithResult(l.hash),localStorage.setItem("itemData",JSON.stringify(t)),alert("✅ Item successfully added to blockchain!"),e.push("/successful")}catch(l){var s;console.error("Blockchain error:",l);let t=null!==(s=null==l?void 0:l.message)&&void 0!==s?s:String(l);alert("❌ Error adding to blockchain: ".concat(t)),e.push("/error")}finally{h(!1)}};return(0,l.jsxs)("div",{className:"min-h-screen bg-white text-gray-800",children:[(0,l.jsx)("header",{className:"bg-white border-b border-gray-200 py-4 px-6",children:(0,l.jsxs)("div",{className:"flex justify-between items-center max-w-6xl mx-auto",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-white font-bold text-xl",children:"B"})}),(0,l.jsx)("span",{className:"text-xl font-bold",children:"BlockVerify"})]}),(0,l.jsx)("nav",{className:"hidden md:flex space-x-6",children:["Home","Admin","MyOrders","Learn"].map(e=>(0,l.jsx)("button",{className:"font-medium text-gray-600 hover:text-gray-900 transition-colors",children:e},e))}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"flex items-center gap-3",children:C()?y&&g?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"px-3 py-2 bg-gray-100 rounded-md text-sm text-gray-800",children:k(g)}),(0,l.jsx)("button",{onClick:I,className:"px-3 py-2 bg-red-500 text-white rounded-md text-sm hover:bg-red-600",children:"Disconnect"})]}):(0,l.jsx)("button",{onClick:A,disabled:j,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700 disabled:opacity-70",children:j?"Connecting...":"Connect Wallet"}):(0,l.jsx)("a",{href:"https://petra.app",target:"_blank",rel:"noreferrer",className:"px-4 py-2 bg-gray-100 rounded-md text-sm text-gray-700 hover:bg-gray-200",children:"Install Petra"})}),(0,l.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]})]})}),(0,l.jsxs)("main",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,l.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-10",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Add Item to Trust-Chain"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Register your product on the blockchain for authenticity tracking"}),v&&(0,l.jsx)("p",{className:"mt-3 text-sm text-red-600",children:v})]}),(0,l.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!g){alert("Please connect your wallet first");return}x(!0),setTimeout(()=>{m(!0),x(!1)},800)},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 md:p-8 mb-8",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8",children:[(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Item Type *"}),(0,l.jsxs)("select",{name:"itemType",value:t.itemType,onChange:T,required:!0,disabled:!y,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors disabled:opacity-50",children:[(0,l.jsx)("option",{value:"",children:"Select item type"}),(0,l.jsx)("option",{value:"shirt",children:"Shirt"}),(0,l.jsx)("option",{value:"pant",children:"Pant"}),(0,l.jsx)("option",{value:"t-shirt",children:"T-Shirt"}),(0,l.jsx)("option",{value:"accessories",children:"Accessories"}),(0,l.jsx)("option",{value:"shorts",children:"Shorts"}),(0,l.jsx)("option",{value:"shoes",children:"Shoes"}),(0,l.jsx)("option",{value:"slippers",children:"Slippers"})]})]}),(0,l.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Item Name *"}),(0,l.jsx)("input",{type:"text",name:"itemName",value:t.itemName,onChange:T,placeholder:"Formal Shirt, Jeans, etc.",required:!0,disabled:!y,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors disabled:opacity-50"})]}),(0,l.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.3},children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Wallet Address *"}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("input",{type:"text",name:"walletAddress",value:t.walletAddress,onChange:T,placeholder:"0x...",required:!0,disabled:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"}),!y&&(0,l.jsx)("div",{className:"absolute inset-0 bg-gray-100 bg-opacity-50 flex items-center justify-center rounded-lg",children:(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"Connect wallet to auto-fill"})})]})]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Sold By *"}),(0,l.jsx)("input",{type:"text",name:"soldBy",value:t.soldBy,onChange:T,placeholder:"Seller name",required:!0,disabled:!y,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors disabled:opacity-50"})]}),(0,l.jsxs)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Order ID *"}),(0,l.jsx)("input",{type:"text",name:"orderId",value:t.orderId,onChange:T,placeholder:"Order identification number",required:!0,disabled:!y,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors disabled:opacity-50"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.3},children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Pickup Date *"}),(0,l.jsx)("input",{type:"date",name:"pickupDate",value:t.pickupDate,onChange:T,required:!0,disabled:!y,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors disabled:opacity-50"})]}),(0,l.jsxs)(i.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.4},children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2 text-gray-700",children:"Pickup Time *"}),(0,l.jsx)("input",{type:"time",name:"pickupTime",value:t.pickupTime,onChange:T,required:!0,disabled:!y,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors disabled:opacity-50"})]})]})]})]}),(0,l.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.5},className:"flex justify-center mt-10",children:(0,l.jsx)("button",{type:"submit",disabled:u||!y,className:"px-8 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors duration-300 disabled:opacity-70 flex items-center",children:u?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Generate QR Code"})})]}),(0,l.jsx)(r.M,{children:n&&(0,l.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.5},className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 md:p-8",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-6 text-center",children:"Item QR Code"}),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-8",children:[(0,l.jsx)("div",{className:"flex justify-center",children:(0,l.jsx)("div",{className:"border-4 border-blue-100 rounded-lg p-4 flex items-center justify-center",children:(0,l.jsx)(o.t,{value:JSON.stringify(t),size:200,level:"H",includeMargin:!0,bgColor:"#FFFFFF",fgColor:"#000000"})})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Item Details"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Item Type"}),(0,l.jsx)("p",{className:"font-medium capitalize",children:t.itemType})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Name"}),(0,l.jsx)("p",{className:"font-medium",children:t.itemName})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Order ID"}),(0,l.jsx)("p",{className:"font-medium",children:t.orderId})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Sold By"}),(0,l.jsx)("p",{className:"font-medium",children:t.soldBy})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Pickup"}),(0,l.jsxs)("p",{className:"font-medium",children:[t.pickupDate," at ",t.pickupTime]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Wallet Address"}),(0,l.jsx)("p",{className:"font-medium text-xs",children:k(t.walletAddress)})]})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 mt-6",children:[(0,l.jsx)(i.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{let e=document.querySelector("canvas");if(!e)return;let s=e.toDataURL("image/png").replace("image/png","image/octet-stream"),l=document.createElement("a");l.href=s,l.download="qrcode-".concat(t.orderId||"item",".png"),document.body.appendChild(l),l.click(),document.body.removeChild(l)},className:"px-6 py-2 bg-blue-600 text-white rounded-lg font-medium",children:"Download QR Code"}),(0,l.jsx)(i.E.button,{onClick:E,disabled:p,whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-6 py-2 bg-orange-500 text-white rounded-lg font-medium disabled:bg-gray-400 flex items-center",children:p?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Adding to Blockchain..."]}):"Add to Blockchain"})]})]})]})]})})]})]})}}},function(e){e.O(0,[664,239,693,893,971,997,744],function(){return e(e.s=667)}),_N_E=e.O()}]);